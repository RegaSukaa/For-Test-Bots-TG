<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GaGBot - –§–µ—Ä–º–µ—Ä—Å–∫–∞—è –∏–≥—Ä–∞</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Roboto+Slab:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        :root {
            --primary: #4CAF50;
            --primary-dark: #388E3C;
            --secondary: #FFC107;
            --secondary-dark: #FFA000;
            --background: #f5f9f6;
            --surface: #FFFFFF;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
            --error: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
            --border-radius: 16px;
            --shadow: 0 6px 15px rgba(0,0,0,0.08);
            --transition: all 0.3s ease;
        }

        body {
            background: linear-gradient(135deg, #e0f7fa, #f1f8e9);
            color: var(--text-primary);
            padding: 16px;
            max-width: 100%;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            width: 100%;
        }

        .header-title {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 10px;
            position: relative;
        }

        .header-title h1 {
            font-family: 'Roboto Slab', serif;
            font-size: 2.5rem;
            color: var(--primary-dark);
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            letter-spacing: 1px;
        }

        .header-title .subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--surface);
            padding: 16px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .game-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .balance-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .balance {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            font-family: 'Roboto Slab', serif;
        }

        .coins-icon {
            color: var(--secondary);
            font-size: 1.8rem;
            animation: shine 2s infinite;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 12px 18px;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            font-size: 0.95rem;
            box-shadow: var(--shadow);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 193, 7, 0.3);
        }

        .btn-neutral {
            background-color: var(--surface);
            color: var(--text-primary);
            border: 1px solid #e0e0e0;
        }

        .btn-neutral:hover {
            background-color: #f5f5f5;
            transform: translateY(-3px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: var(--shadow) !important;
        }

        .section-title {
            font-size: 1.3rem;
            margin-bottom: 16px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary);
        }

        .farm-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .plot {
            aspect-ratio: 1/1;
            background-color: #f1f8e9;
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            border: 2px solid #c5e1a5;
        }

        .plot.empty {
            background-color: #e8f5e9;
            border: 2px dashed var(--primary);
        }

        .plot.growing {
            background-color: #fffde7;
            border-color: #ffd54f;
        }

        .plot.ready {
            background-color: #fff3e0;
            border-color: #ffb74d;
            animation: pulse 1.5s infinite;
        }

        .plot-content {
            text-align: center;
            padding: 10px;
            width: 100%;
            z-index: 2;
        }

        .plant-icon {
            font-size: 2.8rem;
            margin-bottom: 5px;
            transition: transform 0.5s ease;
        }

        .plot.ready .plant-icon {
            animation: bounce 0.8s infinite alternate;
        }

        .plant-name {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .progress-container {
            width: 85%;
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .time-remaining {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 5px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .action-panel {
            background-color: var(--surface);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .harvest-all-btn {
            width: 100%;
            padding: 16px;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .language-switcher {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: auto;
            padding: 16px 0;
        }

        .lang-btn {
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 10px 20px;
            border-radius: 50px;
            transition: var(--transition);
            border: 2px solid #e0e0e0;
        }

        .lang-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border-color: var(--primary);
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: var(--surface);
            width: 90%;
            max-width: 450px;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.25);
            transform: translateY(30px);
            transition: transform 0.4s ease;
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary);
        }

        .modal-title {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary-dark);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: var(--transition);
        }

        .close-btn:hover {
            color: var(--primary);
            transform: rotate(90deg);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞ */
        .shop-items {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 18px;
        }

        .shop-item {
            background: linear-gradient(to bottom, #ffffff, #f5f5f5);
            border-radius: var(--border-radius);
            padding: 18px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            transition: var(--transition);
            border: 1px solid #e0e0e0;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .shop-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.15);
        }

        .shop-item-header {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .shop-item-icon {
            font-size: 2.5rem;
            min-width: 50px;
            text-align: center;
        }

        .shop-item-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary-dark);
            word-break: break-word;
            flex: 1;
        }

        .shop-item-price {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 1rem;
            font-weight: 600;
        }

        .shop-item-stats {
            font-size: 0.85rem;
            color: var(--text-secondary);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
            margin-top: 5px;
        }

        .buy-btn {
            margin-top: 10px;
            width: 100%;
        }

        .availability {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--secondary);
            color: var(--text-primary);
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è */
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .inventory-item {
            background: linear-gradient(to bottom, #ffffff, #f5f5f5);
            border-radius: var(--border-radius);
            padding: 18px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            border: 1px solid #e0e0e0;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .inventory-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .inventory-item-icon {
            font-size: 2.5rem;
        }

        .inventory-item-name {
            font-weight: 600;
            font-size: 1rem;
            text-align: center;
            min-height: 40px;
            display: flex;
            align-items: center;
        }

        .inventory-item-quantity {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border-radius: 50px;
            padding: 4px 12px;
            font-size: 0.95rem;
            font-weight: 700;
            min-width: 35px;
        }

        .inventory-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            width: 100%;
        }

        .action-btn {
            flex: 1;
            padding: 8px;
            font-size: 0.85rem;
        }

        .inventory-fruits {
            width: 100%;
            margin-top: 10px;
            background: #e8f5e9;
            border-radius: 10px;
            padding: 10px;
            max-height: 150px;
            overflow-y: auto;
        }

        .fruit-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px dashed #c8e6c9;
            font-size: 0.9rem;
        }

        .fruit-item:last-child {
            border-bottom: none;
        }

        .fruit-weight {
            font-weight: 600;
            color: var(--primary-dark);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–±–æ—Ä–∞ —É—Ä–æ–∂–∞—è */
        .harvest-summary {
            margin-top: 20px;
            background-color: #e8f5e9;
            border-radius: var(--border-radius);
            padding: 15px;
            border-left: 4px solid var(--success);
        }

        .harvest-title {
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--success);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .harvest-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed #c8e6c9;
        }

        .harvest-item:last-child {
            border-bottom: none;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.7); }
            70% { transform: scale(1.02); box-shadow: 0 0 0 10px rgba(255, 193, 7, 0); }
            100% { transform: scale(1); }
        }

        @keyframes bounce {
            0% { transform: translateY(0); }
            100% { transform: translateY(-10px); }
        }

        @keyframes shine {
            0% { text-shadow: 0 0 5px rgba(255, 215, 0, 0); }
            50% { text-shadow: 0 0 15px rgba(255, 215, 0, 0.8); }
            100% { text-shadow: 0 0 5px rgba(255, 215, 0, 0); }
        }

        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 1001;
            animation: grow 0.4s ease, grow 0.4s ease reverse forwards 2.5s;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        @keyframes grow {
            0% { opacity: 0; top: 0; }
            100% { opacity: 1; top: 20px; }
        }

        .collect-animation {
            position: absolute;
            font-size: 2rem;
            animation: floatUp 1s ease-out forwards;
            z-index: 10;
            pointer-events: none;
        }

        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-100px); opacity: 0; }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 400px) {
            .farm-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .shop-items {
                grid-template-columns: 1fr;
            }
            
            .inventory-grid {
                grid-template-columns: 1fr;
            }

            .btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –±–æ—Ç–∞ -->
        <div class="header-title">
            <h1>GaG Farm</h1>
            <div class="subtitle" id="subtitle">–í—ã—Ä–∞—â–∏–≤–∞–π, —Å–æ–±–∏—Ä–∞–π, –ø—Ä–æ–¥–∞–≤–∞–π!</div>
        </div>

        <!-- –®–∞–ø–∫–∞ —Å –±–∞–ª–∞–Ω—Å–æ–º –∏ –∫–Ω–æ–ø–∫–∞–º–∏ -->
        <div class="game-header">
            <div class="balance-container">
                <i class="fas fa-coins coins-icon"></i>
                <div class="balance" id="balance">20</div>
            </div>
            <div class="action-buttons">
                <button class="btn btn-secondary" id="harvestAllBtn">
                    <i class="fas fa-hand-holding-usd"></i>
                    <span id="harvestBtnText">–°–æ–±—Ä–∞—Ç—å –≤—Å—ë</span>
                </button>
                <button class="btn btn-neutral" id="shopBtn">
                    <i class="fas fa-store"></i>
                </button>
                <button class="btn btn-neutral" id="inventoryBtn">
                    <i class="fas fa-shopping-bag"></i>
                </button>
            </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è –≥—Ä—è–¥–æ–∫ -->
        <div class="action-panel">
            <h2 class="section-title">
                <i class="fas fa-seedling"></i>
                <span id="farmTitle">–í–∞—à–∏ –≥—Ä—è–¥–∫–∏</span>
            </h2>
            <div class="farm-grid" id="farmGrid">
                <!-- –ì—Ä—è–¥–∫–∏ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —è–∑—ã–∫–∞ -->
        <div class="language-switcher">
            <button class="lang-btn active" data-lang="ru">–†—É—Å—Å–∫–∏–π</button>
            <button class="lang-btn" data-lang="en">English</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–∞–≥–∞–∑–∏–Ω–∞ -->
    <div class="modal" id="shopModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-store"></i>
                    <span id="shopTitle">–ú–∞–≥–∞–∑–∏–Ω —Å–µ–º—è–Ω</span>
                </h2>
                <button class="close-btn" id="closeShopModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="shop-items" id="shopItems">
                <!-- –¢–æ–≤–∞—Ä—ã –º–∞–≥–∞–∑–∏–Ω–∞ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
            <div class="shop-timer" style="margin-top: 20px; text-align: center; font-weight: 500; color: var(--text-secondary);">
                <i class="fas fa-sync-alt"></i> 
                <span id="shopTimer">–ú–∞–≥–∞–∑–∏–Ω –æ–±–Ω–æ–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑: 5:00</span>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è -->
    <div class="modal" id="inventoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-shopping-bag"></i>
                    <span id="inventoryTitle">–í–∞—à –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</span>
                </h2>
                <button class="close-btn" id="closeInventoryModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="inventory-grid" id="inventoryGrid">
                <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–±–æ—Ä–∞ —É—Ä–æ–∂–∞—è -->
    <div class="modal" id="harvestModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-hand-holding-usd"></i>
                    <span id="harvestTitle">–£—Ä–æ–∂–∞–π —Å–æ–±—Ä–∞–Ω!</span>
                </h2>
                <button class="close-btn" id="closeHarvestModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="harvest-summary" id="harvestSummary">
                <!-- –°–≤–æ–¥–∫–∞ –ø–æ —Å–æ–±—Ä–∞–Ω–Ω–æ–º—É —É—Ä–æ–∂–∞—é -->
            </div>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        const gameData = {
            balance: 20,
            plots: Array(30).fill().map(() => ({ plant: null, progress: 0, fruits: [] })),
            inventory: {
                seeds: {},
                plants: {}
            },
            plants: {
                carrot: { 
                    name: { ru: "–ú–æ—Ä–∫–æ–≤—å", en: "Carrot" }, 
                    icon: "ü•ï", 
                    seedPrice: 10, 
                    growthTime: 60, 
                    minWeight: 0.1, 
                    maxWeight: 0.3, 
                    pricePerKg: 60, // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
                    fruitCount: 1,
                    repeatGrowth: false,
                    availabilityChance: 1
                },
                tomato: { 
                    name: { ru: "–ü–æ–º–∏–¥–æ—Ä", en: "Tomato" }, 
                    icon: "üçÖ", 
                    seedPrice: 20, 
                    growthTime: 120, 
                    minWeight: 0.2, 
                    maxWeight: 0.5, 
                    pricePerKg: 90, // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
                    fruitCount: 3,
                    repeatGrowth: true,
                    availabilityChance: 0.8
                },
                potato: { 
                    name: { ru: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å", en: "Potato" }, 
                    icon: "ü•î", 
                    seedPrice: 15, 
                    growthTime: 180, 
                    minWeight: 0.3, 
                    maxWeight: 0.7, 
                    pricePerKg: 45, // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
                    fruitCount: 5,
                    repeatGrowth: false,
                    availabilityChance: 0.9
                },
                strawberry: { 
                    name: { ru: "–ö–ª—É–±–Ω–∏–∫–∞", en: "Strawberry" }, 
                    icon: "üçì", 
                    seedPrice: 25, 
                    growthTime: 90, 
                    minWeight: 0.05, 
                    maxWeight: 0.1, 
                    pricePerKg: 120, // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
                    fruitCount: 8,
                    repeatGrowth: true,
                    availabilityChance: 0.7
                },
                cucumber: { 
                    name: { ru: "–û–≥—É—Ä–µ—Ü", en: "Cucumber" }, 
                    icon: "ü•í", 
                    seedPrice: 30, 
                    growthTime: 150, 
                    minWeight: 0.4, 
                    maxWeight: 0.8, 
                    pricePerKg: 52, // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
                    fruitCount: 2,
                    repeatGrowth: true,
                    availabilityChance: 0.6
                },
                mango: { 
                    name: { ru: "–ú–∞–Ω–≥–æ", en: "Mango" }, 
                    icon: "ü•≠", 
                    seedPrice: 150, 
                    growthTime: 300, 
                    minWeight: 0.5, 
                    maxWeight: 1.5, 
                    pricePerKg: 150, // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
                    fruitCount: 1,
                    repeatGrowth: true,
                    availabilityChance: 0.4
                },
                grapes: { 
                    name: { ru: "–í–∏–Ω–æ–≥—Ä–∞–¥", en: "Grapes" }, 
                    icon: "üçá", 
                    seedPrice: 120, 
                    growthTime: 240, 
                    minWeight: 0.1, 
                    maxWeight: 0.3, 
                    pricePerKg: 180, // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
                    fruitCount: 12,
                    repeatGrowth: true,
                    availabilityChance: 0.5
                },
                watermelon: { 
                    name: { ru: "–ê—Ä–±—É–∑", en: "Watermelon" }, 
                    icon: "üçâ", 
                    seedPrice: 80, 
                    growthTime: 360, 
                    minWeight: 3, 
                    maxWeight: 10, 
                    pricePerKg: 37, // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
                    fruitCount: 1,
                    repeatGrowth: false,
                    availabilityChance: 0.3
                },
                peach: { 
                    name: { ru: "–ü–µ—Ä—Å–∏–∫", en: "Peach" }, 
                    icon: "üçë", 
                    seedPrice: 70, 
                    growthTime: 280, 
                    minWeight: 0.3, 
                    maxWeight: 0.6, 
                    pricePerKg: 105, // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
                    fruitCount: 3,
                    repeatGrowth: true,
                    availabilityChance: 0.6
                },
                coconut: { 
                    name: { ru: "–ö–æ–∫–æ—Å", en: "Coconut" }, 
                    icon: "ü••", 
                    seedPrice: 200, 
                    growthTime: 600, 
                    minWeight: 1, 
                    maxWeight: 2.5, 
                    pricePerKg: 135, // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
                    fruitCount: 1,
                    repeatGrowth: true,
                    availabilityChance: 0.2
                }
            },
            currentLanguage: 'ru',
            lastSave: Date.now(),
            shopTimer: 300, // 5 –º–∏–Ω—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            shopItems: {},
            nextShopUpdate: Date.now() + 300000 // 5 –º–∏–Ω—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
        };

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const elements = {
            balance: document.getElementById('balance'),
            farmGrid: document.getElementById('farmGrid'),
            shopBtn: document.getElementById('shopBtn'),
            inventoryBtn: document.getElementById('inventoryBtn'),
            harvestAllBtn: document.getElementById('harvestAllBtn'),
            shopModal: document.getElementById('shopModal'),
            inventoryModal: document.getElementById('inventoryModal'),
            harvestModal: document.getElementById('harvestModal'),
            closeShopModal: document.getElementById('closeShopModal'),
            closeInventoryModal: document.getElementById('closeInventoryModal'),
            closeHarvestModal: document.getElementById('closeHarvestModal'),
            shopItems: document.getElementById('shopItems'),
            inventoryGrid: document.getElementById('inventoryGrid'),
            harvestSummary: document.getElementById('harvestSummary'),
            langButtons: document.querySelectorAll('.lang-btn'),
            shopTimer: document.getElementById('shopTimer'),
            subtitle: document.getElementById('subtitle'),
            harvestBtnText: document.getElementById('harvestBtnText'),
            farmTitle: document.getElementById('farmTitle'),
            shopTitle: document.getElementById('shopTitle'),
            inventoryTitle: document.getElementById('inventoryTitle'),
            harvestTitle: document.getElementById('harvestTitle')
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            loadGame();
            updateShopItems();
            renderFarm();
            renderShop();
            renderInventory();
            setupEventListeners();
            startGameLoop();
            startShopTimer();
            updateUI(); // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–µ–≤–æ–¥ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            elements.shopBtn.addEventListener('click', () => toggleModal(elements.shopModal));
            elements.inventoryBtn.addEventListener('click', () => toggleModal(elements.inventoryModal));
            elements.closeShopModal.addEventListener('click', () => toggleModal(elements.shopModal));
            elements.closeInventoryModal.addEventListener('click', () => toggleModal(elements.inventoryModal));
            elements.closeHarvestModal.addEventListener('click', () => toggleModal(elements.harvestModal));
            elements.harvestAllBtn.addEventListener('click', harvestAll);
            
            elements.langButtons.forEach(btn => {
                btn.addEventListener('click', () => switchLanguage(btn.dataset.lang));
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞
        function updateShopItems() {
            // –ï—Å–ª–∏ –º–∞–≥–∞–∑–∏–Ω —É–∂–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è –∏ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö
            if (Object.keys(gameData.shopItems).length > 0) return;
            
            // –ò–Ω–∞—á–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –º–∞–≥–∞–∑–∏–Ω
            gameData.shopItems = {};
            Object.entries(gameData.plants).forEach(([plantId, plant]) => {
                if (Math.random() < plant.availabilityChance) {
                    gameData.shopItems[plantId] = {
                        quantity: Math.floor(Math.random() * 3) + 1, // 1-3 —à—Ç—É–∫–∏
                        plant: plant
                    };
                }
            });
        }

        // –¢–∞–π–º–µ—Ä –º–∞–≥–∞–∑–∏–Ω–∞
        function startShopTimer() {
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –¥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–∞
            const timeLeft = Math.max(0, Math.floor((gameData.nextShopUpdate - Date.now()) / 1000));
            gameData.shopTimer = timeLeft;
            updateShopTimerDisplay();
            
            const timer = setInterval(() => {
                gameData.shopTimer--;
                updateShopTimerDisplay();
                
                if (gameData.shopTimer <= 0) {
                    updateShopItems();
                    renderShop();
                    gameData.nextShopUpdate = Date.now() + 300000; // +5 –º–∏–Ω—É—Ç
                    gameData.shopTimer = 300;
                    showNotification(
                        gameData.currentLanguage === 'ru' 
                            ? 'üõí –ú–∞–≥–∞–∑–∏–Ω –æ–±–Ω–æ–≤–ª–µ–Ω!' 
                            : 'üõí Shop updated!'
                    );
                }
            }, 1000);
        }
        
        function updateShopTimerDisplay() {
            const mins = Math.floor(gameData.shopTimer / 60);
            const secs = gameData.shopTimer % 60;
            elements.shopTimer.textContent = 
                gameData.currentLanguage === 'ru' 
                    ? `–ú–∞–≥–∞–∑–∏–Ω –æ–±–Ω–æ–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑: ${mins}:${secs.toString().padStart(2, '0')}`
                    : `Shop updates in: ${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞
        function switchLanguage(lang) {
            gameData.currentLanguage = lang;
            
            elements.langButtons.forEach(btn => {
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            updateUI();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤
            elements.subtitle.textContent = 
                gameData.currentLanguage === 'ru' 
                    ? '–í—ã—Ä–∞—â–∏–≤–∞–π, —Å–æ–±–∏—Ä–∞–π, –ø—Ä–æ–¥–∞–≤–∞–π!' 
                    : 'Grow, harvest, sell!';
            
            elements.harvestBtnText.textContent = 
                gameData.currentLanguage === 'ru' 
                    ? '–°–æ–±—Ä–∞—Ç—å –≤—Å—ë' 
                    : 'Harvest All';
            
            elements.farmTitle.textContent = 
                gameData.currentLanguage === 'ru' 
                    ? '–í–∞—à–∏ –≥—Ä—è–¥–∫–∏' 
                    : 'Your Farm';
            
            elements.shopTitle.textContent = 
                gameData.currentLanguage === 'ru' 
                    ? '–ú–∞–≥–∞–∑–∏–Ω —Å–µ–º—è–Ω' 
                    : 'Seed Shop';
            
            elements.inventoryTitle.textContent = 
                gameData.currentLanguage === 'ru' 
                    ? '–í–∞—à –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å' 
                    : 'Your Inventory';
            
            elements.harvestTitle.textContent = 
                gameData.currentLanguage === 'ru' 
                    ? '–£—Ä–æ–∂–∞–π —Å–æ–±—Ä–∞–Ω!' 
                    : 'Harvest Complete!';
            
            renderFarm();
            renderShop();
            renderInventory();
            updateShopTimerDisplay();
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä—è–¥–æ–∫
        function renderFarm() {
            elements.farmGrid.innerHTML = '';
            
            gameData.plots.forEach((plot, index) => {
                const plotElement = document.createElement('div');
                plotElement.className = 'plot';
                
                if (!plot.plant) {
                    plotElement.classList.add('empty');
                    plotElement.innerHTML = `
                        <div class="plot-content">
                            <i class="fas fa-plus-circle plant-icon"></i>
                            <div>${gameData.currentLanguage === 'ru' ? '–ü—É—Å—Ç–æ' : 'Empty'}</div>
                        </div>
                    `;
                    plotElement.addEventListener('click', () => openPlantingDialog(index));
                } else {
                    const plant = gameData.plants[plot.plant];
                    const isReady = plot.progress >= plant.growthTime;
                    
                    if (isReady) {
                        plotElement.classList.add('ready');
                    } else {
                        plotElement.classList.add('growing');
                    }
                    
                    const progressPercent = Math.min(100, (plot.progress / plant.growthTime) * 100);
                    const timeLeft = Math.max(0, plant.growthTime - plot.progress);
                    
                    plotElement.innerHTML = `
                        <div class="plot-content">
                            <div class="plant-icon">${plant.icon}</div>
                            <div class="plant-name">${plant.name[gameData.currentLanguage]}</div>
                            ${!isReady ? `
                                <div class="progress-container">
                                    <div class="progress-bar" style="width: ${progressPercent}%"></div>
                                </div>
                                <div class="time-remaining">
                                    ${formatTime(timeLeft)}
                                </div>
                            ` : `
                                <div style="font-weight: 700; color: var(--success);">${gameData.currentLanguage === 'ru' ? '–ì–æ—Ç–æ–≤–æ!' : 'Ready!'}</div>
                            `}
                        </div>
                    `;
                    
                    if (isReady) {
                        plotElement.addEventListener('click', () => harvestPlant(index));
                    }
                }
                
                elements.farmGrid.appendChild(plotElement);
            });
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞
        function renderShop() {
            elements.shopItems.innerHTML = '';
            
            Object.entries(gameData.shopItems).forEach(([plantId, shopItem]) => {
                const plant = shopItem.plant;
                const quantity = shopItem.quantity;
                
                const shopItemElement = document.createElement('div');
                shopItemElement.className = 'shop-item';
                
                shopItemElement.innerHTML = `
                    <div class="shop-item-header">
                        <div class="shop-item-icon">${plant.icon}</div>
                        <div class="shop-item-name">${plant.name[gameData.currentLanguage]}</div>
                    </div>
                    <div class="availability">${quantity} ${gameData.currentLanguage === 'ru' ? '—à—Ç' : 'pcs'}</div>
                    <div class="shop-item-price">
                        <i class="fas fa-coins" style="color: var(--secondary);"></i>
                        ${plant.seedPrice} ${gameData.currentLanguage === 'ru' ? '–º–æ–Ω–µ—Ç' : 'coins'}
                    </div>
                    <div class="shop-item-stats">
                        <div>${gameData.currentLanguage === 'ru' ? '–í—Ä–µ–º—è —Ä–æ—Å—Ç–∞:' : 'Growth time:'}</div>
                        <div>${formatTime(plant.growthTime)}</div>
                        <div>${gameData.currentLanguage === 'ru' ? '–¶–µ–Ω–∞ –∑–∞ –∫–≥:' : 'Price per kg:'}</div>
                        <div>${plant.pricePerKg}</div>
                        <div>${gameData.currentLanguage === 'ru' ? '–ü–ª–æ–¥–æ–≤:' : 'Fruits:'}</div>
                        <div>${plant.fruitCount}</div>
                    </div>
                    <button class="btn btn-primary buy-btn" data-plant="${plantId}">
                        <i class="fas fa-shopping-cart"></i>
                        ${gameData.currentLanguage === 'ru' ? '–ö—É–ø–∏—Ç—å' : 'Buy'}
                    </button>
                `;
                
                elements.shopItems.appendChild(shopItemElement);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ–∫—É–ø–∫–∏
            document.querySelectorAll('.buy-btn').forEach(btn => {
                btn.addEventListener('click', () => buySeeds(btn.dataset.plant));
            });
            
            // –ï—Å–ª–∏ –º–∞–≥–∞–∑–∏–Ω –ø—É—Å—Ç
            if (Object.keys(gameData.shopItems).length === 0) {
                elements.shopItems.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 30px 0; color: var(--text-secondary);">
                        <i class="fas fa-store-slash" style="font-size: 3rem; margin-bottom: 15px;"></i>
                        <h3>${gameData.currentLanguage === 'ru' ? '–ú–∞–≥–∞–∑–∏–Ω –ø—É—Å—Ç' : 'Shop is empty'}</h3>
                        <p>${gameData.currentLanguage === 'ru' ? '–ñ–¥–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–∞' : 'Waiting for shop update'}</p>
                    </div>
                `;
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function renderInventory() {
            elements.inventoryGrid.innerHTML = '';
            
            // –°–µ–º–µ–Ω–∞
            Object.entries(gameData.inventory.seeds).forEach(([plantId, quantity]) => {
                if (quantity > 0) {
                    const plant = gameData.plants[plantId];
                    const inventoryItem = document.createElement('div');
                    inventoryItem.className = 'inventory-item';
                    
                    inventoryItem.innerHTML = `
                        <div class="inventory-item-icon">${plant.icon}</div>
                        <div class="inventory-item-name">${plant.name[gameData.currentLanguage]}</div>
                        <div class="inventory-item-quantity">${quantity}</div>
                        <div class="inventory-actions">
                            <button class="btn btn-primary action-btn" data-action="plant" data-plant="${plantId}">
                                ${gameData.currentLanguage === 'ru' ? '–°–∞–∂–∞—Ç—å' : 'Plant'}
                            </button>
                        </div>
                    `;
                    
                    elements.inventoryGrid.appendChild(inventoryItem);
                }
            });
            
            // –†–∞—Å—Ç–µ–Ω–∏—è
            Object.entries(gameData.inventory.plants).forEach(([plantId, items]) => {
                if (items.length > 0) {
                    const plant = gameData.plants[plantId];
                    const totalQuantity = items.length;
                    
                    const inventoryItem = document.createElement('div');
                    inventoryItem.className = 'inventory-item';
                    
                    // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ –ø–ª–æ–¥–æ–≤
                    let fruitsHTML = '';
                    items.forEach((fruit, index) => {
                        const value = (fruit * plant.pricePerKg).toFixed(1);
                        fruitsHTML += `
                            <div class="fruit-item">
                                <span>${gameData.currentLanguage === 'ru' ? '–ü–ª–æ–¥' : 'Fruit'} ${index+1}:</span>
                                <span class="fruit-weight">${fruit} –∫–≥</span>
                                <span>(${value} <i class="fas fa-coins" style="color: var(--secondary);"></i>)</span>
                            </div>
                        `;
                    });
                    
                    inventoryItem.innerHTML = `
                        <div class="inventory-item-icon">${plant.icon}</div>
                        <div class="inventory-item-name">${plant.name[gameData.currentLanguage]}</div>
                        <div class="inventory-item-quantity">${totalQuantity}</div>
                        <div class="inventory-fruits">
                            ${fruitsHTML}
                        </div>
                        <div class="inventory-actions">
                            <button class="btn btn-primary action-btn" data-action="sell-one" data-plant="${plantId}">
                                ${gameData.currentLanguage === 'ru' ? '–ü—Ä–æ–¥–∞—Ç—å 1' : 'Sell 1'}
                            </button>
                            <button class="btn btn-secondary action-btn" data-action="sell-all" data-plant="${plantId}">
                                ${gameData.currentLanguage === 'ru' ? '–í—Å–µ' : 'All'}
                            </button>
                        </div>
                    `;
                    
                    elements.inventoryGrid.appendChild(inventoryItem);
                }
            });
            
            // –ï—Å–ª–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç
            if (elements.inventoryGrid.children.length === 0) {
                elements.inventoryGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 30px 0; color: var(--text-secondary);">
                        <i class="fas fa-box-open" style="font-size: 3rem; margin-bottom: 15px;"></i>
                        <h3>${gameData.currentLanguage === 'ru' ? '–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç' : 'Inventory is empty'}</h3>
                        <p>${gameData.currentLanguage === 'ru' ? '–ö—É–ø–∏—Ç–µ —Å–µ–º–µ–Ω–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ' : 'Buy seeds in the shop'}</p>
                    </div>
                `;
            } else {
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
                document.querySelectorAll('.action-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const action = btn.dataset.action;
                        const plantId = btn.dataset.plant;
                        
                        if (action === 'plant') {
                            openPlantingDialogWithPlant(plantId);
                        } else if (action === 'sell-one') {
                            sellPlant(plantId, 1);
                        } else if (action === 'sell-all') {
                            sellPlant(plantId, 'all');
                        }
                    });
                });
            }
        }

        // –ü–æ–∫—É–ø–∫–∞ —Å–µ–º—è–Ω
        function buySeeds(plantId) {
            const shopItem = gameData.shopItems[plantId];
            if (!shopItem || shopItem.quantity <= 0) {
                showNotification(
                    gameData.currentLanguage === 'ru' 
                        ? '–≠—Ç–∏ —Å–µ–º–µ–Ω–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å!' 
                        : 'These seeds are sold out!',
                    'error'
                );
                return;
            }
            
            const plant = shopItem.plant;
            
            if (gameData.balance >= plant.seedPrice) {
                gameData.balance -= plant.seedPrice;
                
                // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –º–∞–≥–∞–∑–∏–Ω–µ
                shopItem.quantity--;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                if (!gameData.inventory.seeds[plantId]) {
                    gameData.inventory.seeds[plantId] = 0;
                }
                
                gameData.inventory.seeds[plantId]++;
                updateBalance();
                renderShop();
                renderInventory();
                showNotification(
                    gameData.currentLanguage === 'ru' 
                        ? `–ö—É–ø–ª–µ–Ω—ã —Å–µ–º–µ–Ω–∞: ${plant.name.ru}` 
                        : `Bought seeds: ${plant.name.en}`
                );
                
                // –ê–Ω–∏–º–∞—Ü–∏—è
                createCollectAnimation('üí∞', 'var(--secondary)');
            } else {
                showNotification(
                    gameData.currentLanguage === 'ru' 
                        ? '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!' 
                        : 'Not enough coins!',
                    'error'
                );
            }
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞ –ø–æ—Å–∞–¥–∫–∏
        function openPlantingDialog(plotIndex) {
            // –ï—Å–ª–∏ —É –∏–≥—Ä–æ–∫–∞ –µ—Å—Ç—å —Å–µ–º–µ–Ω–∞, –æ—Ç–∫—Ä—ã—Ç—å –≤—ã–±–æ—Ä —Å–µ–º—è–Ω
            if (Object.values(gameData.inventory.seeds).some(qty => qty > 0)) {
                toggleModal(elements.inventoryModal);
            } else {
                showNotification(
                    gameData.currentLanguage === 'ru' 
                        ? '–ö—É–ø–∏—Ç–µ —Å–µ–º–µ–Ω–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ!' 
                        : 'Buy seeds in the shop!',
                    'error'
                );
            }
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞ –ø–æ—Å–∞–¥–∫–∏ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —Ä–∞—Å—Ç–µ–Ω–∏–µ–º
        function openPlantingDialogWithPlant(plantId) {
            toggleModal(elements.inventoryModal);
            
            // –ù–∞–π—Ç–∏ —Å–≤–æ–±–æ–¥–Ω—É—é –≥—Ä—è–¥–∫—É
            const freePlotIndex = gameData.plots.findIndex(plot => !plot.plant);
            
            if (freePlotIndex !== -1) {
                plantSeed(freePlotIndex, plantId);
            } else {
                showNotification(
                    gameData.currentLanguage === 'ru' 
                        ? '–ù–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö –≥—Ä—è–¥–æ–∫!' 
                        : 'No free plots!',
                    'error'
                );
            }
        }

        // –ü–æ—Å–∞–¥–∫–∞ —Å–µ–º—è–Ω
        function plantSeed(plotIndex, plantId) {
            if (gameData.inventory.seeds[plantId] > 0) {
                gameData.inventory.seeds[plantId]--;
                
                gameData.plots[plotIndex] = {
                    plant: plantId,
                    progress: 0,
                    fruits: []
                };
                
                renderFarm();
                renderInventory();
                showNotification(
                    gameData.currentLanguage === 'ru' 
                        ? `–ü–æ—Å–∞–∂–µ–Ω–æ: ${gameData.plants[plantId].name.ru}` 
                        : `Planted: ${gameData.plants[plantId].name.en}`
                );
                
                // –ê–Ω–∏–º–∞—Ü–∏—è
                createCollectAnimation('üå±', 'var(--primary)');
            }
        }

        // –°–±–æ—Ä —É—Ä–æ–∂–∞—è —Å –æ–¥–Ω–æ–π –≥—Ä—è–¥–∫–∏
        function harvestPlant(plotIndex) {
            const plot = gameData.plots[plotIndex];
            const plant = gameData.plants[plot.plant];
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–ª–æ–¥—ã
            const fruits = [];
            for (let i = 0; i < plant.fruitCount; i++) {
                const weight = (Math.random() * (plant.maxWeight - plant.minWeight) + plant.minWeight).toFixed(2);
                fruits.push(weight);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            if (!gameData.inventory.plants[plot.plant]) {
                gameData.inventory.plants[plot.plant] = [];
            }
            
            gameData.inventory.plants[plot.plant] = gameData.inventory.plants[plot.plant].concat(fruits);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–±—Ä–∞–Ω–Ω–æ–º —É—Ä–æ–∂–∞–µ
            let message = gameData.currentLanguage === 'ru' 
                ? `–°–æ–±—Ä–∞–Ω–æ: ${plant.name.ru}<br>`
                : `Harvested: ${plant.name.en}<br>`;
            
            fruits.forEach((weight, i) => {
                message += `üçé ${gameData.currentLanguage === 'ru' ? '–ü–ª–æ–¥' : 'Fruit'} ${i+1}: ${weight} –∫–≥<br>`;
            });
            
            showNotification(message);
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞—Å—Ç–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–±–æ—Ä–∞
            if (plant.repeatGrowth) {
                // –î–ª—è –º–Ω–æ–≥–æ–ª–µ—Ç–Ω–∏—Ö —Ä–∞—Å—Ç–µ–Ω–∏–π - —Å–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                gameData.plots[plotIndex].progress = 0;
                gameData.plots[plotIndex].fruits = [];
            } else {
                // –î–ª—è –æ–¥–Ω–æ–ª–µ—Ç–Ω–∏—Ö - –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º –≥—Ä—è–¥–∫—É
                gameData.plots[plotIndex] = { plant: null, progress: 0, fruits: [] };
            }
            
            renderFarm();
            renderInventory();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            createCollectAnimation(plant.icon, '#FF9800');
        }

        // –°–±–æ—Ä –≤—Å–µ–≥–æ —É—Ä–æ–∂–∞—è
        function harvestAll() {
            let harvested = false;
            const harvestSummary = {};
            
            gameData.plots.forEach((plot, index) => {
                if (plot.plant && plot.progress >= gameData.plants[plot.plant].growthTime) {
                    const plant = gameData.plants[plot.plant];
                    
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–ª–æ–¥—ã
                    const fruits = [];
                    for (let i = 0; i < plant.fruitCount; i++) {
                        const weight = (Math.random() * (plant.maxWeight - plant.minWeight) + plant.minWeight).toFixed(2);
                        fruits.push(weight);
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–≤–æ–¥–∫—É
                    if (!harvestSummary[plot.plant]) {
                        harvestSummary[plot.plant] = {
                            name: plant.name[gameData.currentLanguage],
                            icon: plant.icon,
                            count: plant.fruitCount,
                            fruits: []
                        };
                    }
                    harvestSummary[plot.plant].fruits = harvestSummary[plot.plant].fruits.concat(fruits);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                    if (!gameData.inventory.plants[plot.plant]) {
                        gameData.inventory.plants[plot.plant] = [];
                    }
                    gameData.inventory.plants[plot.plant] = gameData.inventory.plants[plot.plant].concat(fruits);
                    
                    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞—Å—Ç–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–±–æ—Ä–∞
                    if (plant.repeatGrowth) {
                        gameData.plots[index].progress = 0;
                        gameData.plots[index].fruits = [];
                    } else {
                        gameData.plots[index] = { plant: null, progress: 0, fruits: [] };
                    }
                    
                    harvested = true;
                    
                    // –ê–Ω–∏–º–∞—Ü–∏—è
                    createCollectAnimation(plant.icon, '#FF9800');
                }
            });
            
            if (harvested) {
                renderFarm();
                renderInventory();
                showHarvestSummary(harvestSummary);
            } else {
                showNotification(
                    gameData.currentLanguage === 'ru' 
                        ? '–ù–µ—Ç –≥–æ—Ç–æ–≤—ã—Ö –∫ —Å–±–æ—Ä—É —Ä–∞—Å—Ç–µ–Ω–∏–π!' 
                        : 'No plants ready for harvest!',
                    'warning'
                );
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–≤–æ–¥–∫—É –ø–æ —Å–æ–±—Ä–∞–Ω–Ω–æ–º—É —É—Ä–æ–∂–∞—é
        function showHarvestSummary(summary) {
            let html = `
                <div class="harvest-title">
                    <i class="fas fa-basket-shopping"></i>
                    ${gameData.currentLanguage === 'ru' ? '–í—ã —Å–æ–±—Ä–∞–ª–∏:' : 'You harvested:'}
                </div>
            `;
            
            Object.values(summary).forEach(item => {
                html += `
                    <div class="harvest-item">
                        <div><span style="font-size: 1.2em;">${item.icon}</span> ${item.name}</div>
                        <div>${item.fruits.length} ${gameData.currentLanguage === 'ru' ? '–ø–ª–æ–¥–æ–≤' : 'fruits'}</div>
                    </div>
                `;
            });
            
            elements.harvestSummary.innerHTML = html;
            toggleModal(elements.harvestModal);
        }

        // –ü—Ä–æ–¥–∞–∂–∞ —Ä–∞—Å—Ç–µ–Ω–∏–π
        function sellPlant(plantId, amount) {
            const plants = gameData.inventory.plants[plantId];
            if (!plants || plants.length === 0) return;
            
            const plant = gameData.plants[plantId];
            let totalIncome = 0;
            let itemsSold = 0;
            
            if (amount === 'all') {
                // –ü—Ä–æ–¥–∞–µ–º –≤—Å–µ
                plants.forEach(weight => {
                    totalIncome += weight * plant.pricePerKg;
                });
                itemsSold = plants.length;
                gameData.inventory.plants[plantId] = [];
            } else {
                // –ü—Ä–æ–¥–∞–µ–º —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
                const toSell = Math.min(amount, plants.length);
                for (let i = 0; i < toSell; i++) {
                    totalIncome += plants[i] * plant.pricePerKg;
                    itemsSold++;
                }
                gameData.inventory.plants[plantId] = plants.slice(itemsSold);
            }
            
            totalIncome = Math.round(totalIncome);
            gameData.balance += totalIncome;
            
            updateBalance();
            renderInventory();
            showNotification(
                gameData.currentLanguage === 'ru' 
                    ? `–ü—Ä–æ–¥–∞–Ω–æ ${itemsSold} ${plant.name.ru} –∑–∞ ${totalIncome} –º–æ–Ω–µ—Ç` 
                    : `Sold ${itemsSold} ${plant.name.en} for ${totalIncome} coins`
            );
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            createCollectAnimation('üí∞', 'var(--secondary)');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
        function updateBalance() {
            elements.balance.textContent = gameData.balance;
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function toggleModal(modal) {
            modal.classList.toggle('active');
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–±–æ—Ä–∞
        function createCollectAnimation(icon, color) {
            const anim = document.createElement('div');
            anim.className = 'collect-animation';
            anim.innerHTML = icon;
            anim.style.color = color;
            anim.style.position = 'fixed';
            anim.style.left = `${Math.random() * 80 + 10}%`;
            anim.style.top = '80%';
            anim.style.fontSize = '2.5rem';
            anim.style.zIndex = '1000';
            document.body.appendChild(anim);
            
            setTimeout(() => {
                anim.remove();
            }, 1000);
        }

        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function startGameLoop() {
            setInterval(() => {
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä–æ—Å—Ç–∞ —Ä–∞—Å—Ç–µ–Ω–∏–π
                gameData.plots.forEach(plot => {
                    if (plot.plant && plot.progress < gameData.plants[plot.plant].growthTime) {
                        plot.progress += 1;
                    }
                });
                
                renderFarm();
                
                // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
                if (Date.now() - gameData.lastSave > 10000) {
                    saveGame();
                    gameData.lastSave = Date.now();
                }
            }, 1000);
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã
        function saveGame() {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ –∏ –≤—Ä–µ–º—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            gameData.nextShopUpdate = Date.now() + gameData.shopTimer * 1000;
            localStorage.setItem('gagbot_save', JSON.stringify(gameData));
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã
        function loadGame() {
            const save = localStorage.getItem('gagbot_save');
            if (save) {
                const parsed = JSON.parse(save);
                Object.assign(gameData, parsed);
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –¥–ª—è —Ç–∞–π–º–µ—Ä–∞ –º–∞–≥–∞–∑–∏–Ω–∞
                if (gameData.nextShopUpdate) {
                    const timeLeft = Math.max(0, Math.floor((gameData.nextShopUpdate - Date.now()) / 1000));
                    gameData.shopTimer = timeLeft;
                }
                
                updateBalance();
            }
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
